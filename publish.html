<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Publish js13K</title>
    
  </head>
  <body>
    <pre id="result"></pre>
  </body> 
                      
  <script>
    
const MINIFY = true;
    
// Minify at https://www.uglifyjs.net/
// Use:
// - Mangle names
// - NOT: Mangle properties !!
// - Mangle function names
// - Mangle variables in top level scope    
    
// Then use https://lifthrasiir.github.io/roadroller/
// Note that Road Roller has some bugs sometimes the resulting code does not work
// - Optimize parameters to reduce size
// - Playing around with the advanced parameters can reduce Road Roller size even more but may increase .zip size...
// - In case of bug unexpected token 'charCodeAtUinyxp' try Allow the decoder to pollute the global scope
// - In case of bug with unterminated regex expression try to reduce the number of abbriviations

var FILES = `
voxelmodel.js
svoxmodel.js
svoxmeshgenerator.js
svox.js
city.js
avoidbuildings.js
vehicles.js
catwalk.js
spray.js
movecontrols.js
thirdpersoncamera.js
kitten.js
score.js
music.js
sounds.js
scene.js
`.replace('index.js', '').replace('svoxmodelexport.js', '');

var DONOTABBRIVIATE = `
oa
attachEventListeners
camera
cameraEl
canvas
catSit
catStand
channel
clamp
code
color
constructor
cos
data
day
deform
desktop
distance
dot
emit
environment
fade
float
floor
fly
found
frequency
geometry
get
handleClick
height
imageData
img
init
kitten
left
length
lerp
main
map
material
max
mesh
min
night
normal
normalize
object3D
offset
onBlur
onclick
onKeyDown
onKeyUp
onload
pause
play
position
position
radius
remove
repeat
right
rotation
scale
scatter
scene
sceneEl
set
setTimeout
side
sin
size
step
thumbstickMoved
tick
tock
toSRgb
toString
update
value
vec3
vertexColors
voxels
width
`;

// Minify these function and variable names for extra small code
var ABBRIVIATE = `
addLinks
allKittens
allSidesObstructed
ambient
amplitude
aoMaterial
attachEventListeners
audioData
average
AXIS
back
backLevel
BLOCK
border
buffer
building
buildScene
cachedMesh
calcAo
calcShadow
calculatePosition
cars
CATDEAD
catDead
catDistance
catEl
CATMODELS
catPosition
cell
CENTER
centerDistance
checkAndUpdatePosition
chunk
CITYPARKS
CLAMP
clamped
classifyBuildings
classifyRoads
cleanupCityLayout
clock
closestX
closestZ
connection
COUNT
count
createCityLayout
createModel
createRgbColors
createSvoxModel
createVoxelMatrix
ctx
currentPosition
currentX
currentZ
dead
decode
decoded
decodeRLE
definition
delayedDistance
delta
deltaX
deltaZ
desiredPosition
determinBuildingObstructions
dif02
dif13
diff
dir
DIRECTION
direction
directionChangesPerSecond
directionCount
distanceThisTick
distanceX
distanceZ
duration
ELANE
elapsed
elPosition
encodeWAV
endPoint
errorMaterial
ESIDE
ETOE
ETON
ETOPNTOW
ETOPSTOW
ETOPTOW
ETOS
expectedLength
FACE
face
faceClamped
FACECOUNT
faceMaterial
faceObstructed
faceOnBoundary
faces
faceSemiObstructed
findConnectedRoads
firstKittenInLine
flattenMaterials
floorColors
FLOORCOUNT
FLOORHEIGHT
floorIndex
FLOORS
followCount
followDistance
front
frontLevel
generate
generateCar
generateCat
generateEngineSound
generateGeometry
generateHonkSound
generateVoxels
getGroundLevel
getOrAddPosition
getOrAddVertex
getRgbColor
getVertex
getVoxel
grid
gridPoint
groundFloorColors
GROUNDFLOORCOUNT
GROUNDFLOORHEIGHT
groundFloorIndex
GROUNDFLOORS
groupId
handleStep
HEIGHT
hexToRgbColor
index
inShadow
key
kittenComp
kittens
lastPosition
lastRotation
len
lightColor
lightDirection
lighting
lightIntensity
linearColor
linkIndex
links
localKeys
localStepTime
mat
materialClass
materialConstructor
materials
matrix
matrixId
maxDeformCount
maxDelay
maxFloors
melody1
melody2
MERGECOUNT
meshCache
meshMaterial
minDistance
minDistanceX
minDistanceZ
MLANE
model
modelName
modelString
models
movement
movements
myPosition
nearest
newLocalPosition
newPitch
newPosition
newVertices
newY
nextCell
NLANE
NSIDE
NTOE
NTON
NTOPETOS
NTOPWTOS
NTOW
numSamples
numSegments
obstructedHeight
obstructing
occupied
onFirstPlay
originalPosition
outOfBounds
overlap
overTime
params
PARK
park
PARKCOUNT
PARKE
PARKHEIGHT
parkIndex
PARKING
PARKLAYOUT
PARKN
PARKS
PARKW
pickRandomPosition
PLANAR
playMusic
points
pos
positionIndexMap
positionProperties
positions
postfixes
properties
property
props
pushbackX
pushbackY
rand
randomBuildingMaterial
randomIndex
randomMovement
ratio
removeEventListeners
result
rgb
rleString
ROAD
rotate
rotationY
sample
sampleRate
SCALE
secondPart
segmentIndex
segmentTransformations
segmentTransformationsBack
segmentTransformationsFront
setVoxel
shadow
shadowMaterial
shadowOaMaterial
SIZE
SKIP
skip
SLANE
smoothMove
smoothRotate
speed
speedX
speedZ
SSIDE
startMusic
startNextStep
startPoint
startTime
state
stepTime
STOE
STOPETON
STOPWTON
STOS
STOW
SVOX
SvoxMeshGenerator
SvoxModel
svoxModel
svoxPositionIndex
targetEl
targetPosition
targets
targetWorldPosition
textValue
thumbdirection
token
tokenize
tokenizer
totalDistance
vCurrent
VEHICLEMODELS
VEHICLEMOVEMENTS
VEHICLES
VEHICLESTEPLENGTH
velocity
vertex
vertexIndexMap
vertices
view
vNext
vox
voxelCount
voxelId
voxelIndex
VoxelMatrix
VoxelModel
voxelModel
voxelX
voxelZ
voxNX
voxNZ
voxPX
voxPZ
voxString
walkMeshes
WLANE
worldPos
writeString
WSIDE
WTON
WTOPNTOE
WTOPSTOE
WTOS
WTOW
xDiffBottom
xDiffTop
yDiffBottom
yDiffTop
yRotationQuaternion
zDiffBottom
zDiffTop
`;    
    
  </script>

  <script src="publish.js"></script>
  
  <script>

    let result = "/**************************************\\\r\n" +
                 "*       Entry for j213KGames          *\r\n" +
                 "* Copyright (c) " + new Date().getFullYear() + " Samuel Van Egmond *\r\n" +
                 "*           MIT License                *\r\n" +
                 "\\**************************************/\r\n" +
                 "\r\n" +
                 "/* global AFRAME */\r\n" +
                 "/* global THREE */\r\n" +
                 "\r\n" +
                 "\"use strict\";\r\n";
        
    // Convert the files
    convertFiles(); 
  
  </script>
</html>
       
 